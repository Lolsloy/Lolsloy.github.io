<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SetHub News</title>
  <meta name="description" content="SetHub News" />
  <meta name="theme-color" content="#0E141A" />
  <link rel="icon" type="image/png" href="Bilder/lagos.png" />

  <style>
    :root{
      --bg:#0E141A;
      --fg-on:#E6E9ED;
      --glass:rgba(16,24,32,.65);
      --shadow:0 26px 90px rgba(0,0,0,.55);
      --r2:23px;
    }

    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      color:var(--fg-on);
      background:var(--bg);
      overflow-x:hidden;
      min-height:100vh;
    }
    img{max-width:100%;display:block;height:auto}
    a{color:inherit;text-decoration:none}

    header.site{
      position:fixed;
      left:0; right:0; top:0;
      height:78px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:var(--glass);
      backdrop-filter:blur(10px);
      border-bottom:1px solid #0f1a22;
      z-index:30;
    }

    .nav-brand{display:flex;align-items:center;justify-content:center;gap:.6rem}
    .nav-logo{height:48px;width:auto;display:grid;place-items:center;transform:translateY(2px)}
    .logo-svg{width:100%;height:100%;display:block}
    .nav-text{
      display:flex;align-items:center;gap:.15em;line-height:1;
      font-weight:900;letter-spacing:.04em;color:#fff;font-size:1.6rem;
    }
    .nav-text span{cursor:default}

    .burger{
      position:fixed;top:16px;left:14px;z-index:40;
      width:46px;height:46px;border-radius:12px;
      background:rgba(16,24,32,.7);
      border:1px solid #1f2a35;
      backdrop-filter:blur(10px);
      display:grid;place-items:center;cursor:pointer;
    }
    .burger .lines{width:20px;height:14px;position:relative}
    .burger .lines span{
      position:absolute;left:0;right:0;height:2px;background:#e8eef4;border-radius:2px;
      transition:transform .25s ease, opacity .2s ease, top .25s ease;
    }
    .burger .lines span:nth-child(1){top:0}
    .burger .lines span:nth-child(2){top:6px}
    .burger .lines span:nth-child(3){top:12px}
    body.drawer-open .burger .lines span:nth-child(1){top:6px;transform:rotate(45deg)}
    body.drawer-open .burger .lines span:nth-child(2){opacity:0}
    body.drawer-open .burger .lines span:nth-child(3){top:6px;transform:rotate(-45deg)}

    .top-links{
      position:fixed;top:16px;left:68px;z-index:41;
      display:flex;gap:10px;
    }
    .top-link{
      height:46px;padding:0 14px;border-radius:12px;
      background:rgba(16,24,32,.7);
      border:1px solid #1f2a35;
      backdrop-filter:blur(10px);
      display:flex;align-items:center;gap:10px;
      cursor:pointer;user-select:none;font-weight:800;color:#fff;letter-spacing:.02em;
    }
    .top-link:hover{background:rgba(19,32,42,.85)}
    .top-link span{color:#b7c2cc;font-weight:700}
    @media (max-width:520px){
      .top-links{left:64px; gap:8px}
      .top-link{padding:0 12px}
      .top-link span{display:none}
    }

    .drawer{
      position:fixed;top:0;left:0;bottom:0;z-index:39;
      width:min(320px,86vw);
      background:rgba(12,18,24,.98);
      border-right:1px solid #16212a;
      transform:translateX(-100%);
      transition:transform .32s ease;
      display:flex;flex-direction:column;
      padding:90px 18px 18px;
      gap:10px;
    }
    body.drawer-open .drawer{transform:translateX(0)}
    .drawer a{
      display:flex;align-items:center;justify-content:space-between;
      padding:14px 14px;border-radius:12px;
      background:#0f1820;border:1px solid #1a2530;
      font-weight:700;letter-spacing:.02em;
    }
    .drawer a:hover{background:#13202a}
    .drawer small{color:#94a3b8;font-weight:600}
    .drawer-backdrop{
      position:fixed;inset:0;z-index:38;
      background:rgba(0,0,0,.45);
      opacity:0;pointer-events:none;
      transition:opacity .25s ease;
    }
    body.drawer-open .drawer-backdrop{opacity:1;pointer-events:auto}

    main{padding:92px 5% 56px;width:min(1200px,100%);margin:0 auto}

    .panel{
      border-radius:var(--r2);
      background:
        radial-gradient(1200px 700px at 72% 22%, rgba(236,72,153,.22), transparent 70%),
        radial-gradient(1100px 650px at 78% 82%, rgba(59,130,246,.18), transparent 65%),
        rgba(15,22,30,.68);
      border:1px solid #223041;
      box-shadow:var(--shadow);
      padding:18px;
    }

    .section-title{font-weight:900;font-size:2.6rem;letter-spacing:.01em;margin:18px 0 12px}
    @media (max-width:700px){.section-title{font-size:2.2rem}}

    .slider{
      position:relative;border-radius:16px;overflow:hidden;
      background:#0b1218;border:1px solid rgba(255,255,255,.08);
    }
    .track{display:flex;transition:transform .4s ease;will-change:transform}
    .slide{min-width:100%;position:relative;height:320px;display:block}
    @media (max-width:700px){.slide{height:260px}}
    .slide img{width:100%;height:100%;object-fit:cover}
    .slide .fade{position:absolute;inset:0;background:linear-gradient(180deg, rgba(0,0,0,0) 35%, rgba(0,0,0,.75) 100%)}
    .slide .meta{position:absolute;left:18px;bottom:16px;right:18px;display:flex;flex-direction:column;gap:6px}
    .meta .small{color:#cfd6dd;font-weight:700;font-size:.95rem;opacity:.9}
    .meta .big{
      font-weight:900;font-size:1.6rem;letter-spacing:.01em;
      display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;
    }

    .dots{display:flex;justify-content:center;gap:12px;padding:12px 0 2px}
    .dot{
      width:12px;height:12px;border-radius:999px;
      border:1px solid rgba(255,255,255,.25);
      background:rgba(255,255,255,.12);
      cursor:pointer;
    }
    .dot[aria-current="true"]{background:#fff;border-color:#fff}

    .row3{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:16px}
    @media (max-width:900px){.row3{grid-template-columns:repeat(2,minmax(0,1fr))}}
    @media (max-width:620px){.row3{grid-template-columns:1fr}}

    .news-card{
      border-radius:16px;overflow:hidden;
      border:1px solid rgba(255,255,255,.08);
      background:linear-gradient(180deg,#101820,#0b1218);
      position:relative;
    }
    .news-card .thumb{height:170px;background:#0b1218;position:relative}
    .news-card .thumb img{width:100%;height:100%;object-fit:cover}
    .news-card .arrow{
      position:absolute;right:12px;bottom:12px;
      width:34px;height:34px;border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(16,24,32,.45);
      display:grid;place-items:center;
    }
    .news-card .arrow svg{width:18px;height:18px;color:#fff}
    .news-card .txt{padding:12px 12px 14px;text-align:center;display:flex;flex-direction:column;gap:6px}
    .news-card .t1{
      font-weight:900;font-size:.95rem;line-height:1.2;
      display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;
    }
    .news-card .t2{font-weight:800;font-size:.92rem;color:#d7dde3;line-height:1.2;opacity:.92}

    .skeleton{
      border-radius:16px;
      border:1px solid rgba(255,255,255,.08);
      background:rgba(16,24,32,.35);
      height:240px;
    }
  </style>
</head>

<body>
  <svg width="0" height="0" style="position:absolute;left:-9999px;top:-9999px" aria-hidden="true" focusable="false">
    <symbol id="sethub-logo" viewBox="0 0 3326 2408" preserveAspectRatio="xMidYMid meet">
      <defs>
        <g id="logo-geometry">
          <g id="Ebene_3">
            <path fill="#04d5eb" fill-rule="evenodd" d="M1421.54,318.24c22.25,62.73,139.85,77.99,200.88,77.76,17.07-.06,161.51-2.01,187.92-71.28,7.3-19.15,6.91-46.93,6.48-77.76-.45-31.95-.57-47.96-5.79-61.91-24.9-66.46-125.71-83.15-149.73-87.13-16.28-2.7-49.47-6.7-90.72,0-27.93,4.54-123.89,20.12-149.04,84.24-6.27,16-6.23,32.31-6.48,64.8-.17,22.34-.39,51.9,6.48,71.28ZM1434.5,208.08c0-48.05,91.62-90.72,184.74-90.72s178.14,42.67,178.14,90.72-91.62,97.2-184.74,97.2-178.14-49.15-178.14-97.2Z"></path>
            <path fill="#04d5eb" fill-rule="evenodd" d="M1826.54,534.24c22.25,62.73,139.85,77.99,200.88,77.76,17.07-.06,161.51-2.01,187.92-71.28,7.3-19.15,6.91-46.93,6.48-77.76-.45-31.95-.57-47.96-5.79-61.91-24.9-66.46-125.71-83.15-149.73-87.13-16.28-2.7-49.47-6.7-90.72,0-27.93,4.54-123.89,20.12-149.04,84.24-6.27,16-6.23,32.31-6.48,64.8-.17,22.34-.39,51.9,6.48,71.28ZM1839.5,424.08c0-48.05,91.62-90.72,184.74-90.72s178.14,42.67,178.14,90.72-91.62,97.2-184.74,97.2-178.14-49.15-178.14-97.2Z"></path>
            <path fill="#04d5eb" fill-rule="evenodd" d="M1421.54,799.99c22.25,62.73,139.85,77.99,200.88,77.76,17.07-.06,161.51-2.01,187.92-71.28,7.3-19.15,6.91-46.93,6.48-77.76-.45-31.95-.57-47.96-5.79-61.91-24.9-66.46-125.71-83.15-149.73-87.13-16.28-2.7-49.47-6.7-90.72,0-27.93,4.54-123.89,20.12-149.04,84.24-6.27,16-6.23,32.31-6.48,64.8-.17,22.34-.39,51.9,6.48,71.28ZM1434.5,689.83c0-48.05,91.62-90.72,184.74-90.72s178.14,42.67,178.14,90.72-91.62,97.2-184.74,97.2-178.14-49.15-178.14-97.2Z"></path>
            <path fill="#04d5eb" fill-rule="evenodd" d="M1019.52,534.24c22.25,62.73,139.85,77.99,200.88,77.76,17.07-.06,161.51-2.01,187.92-71.28,7.3-19.15,6.91-46.93,6.48-77.76-.45-31.95-.57-47.96-5.79-61.91-24.9-66.46-125.71-83.15-149.73-87.13-16.28-2.7-49.47-6.7-90.72,0-27.93,4.54-123.89,20.12-149.04,84.24-6.27,16-6.23,32.31-6.48,64.8-.17,22.34-.39,51.9,6.48,71.28ZM1032.48,424.08c0-48.05,91.62-90.72,184.74-90.72s178.14,42.67,178.14,90.72-91.62,97.2-184.74,97.2-178.14-49.15-178.14-97.2Z"></path>
          </g>
          <g id="Ebene_5">
            <path fill="#04d5eb" d="M1586,1605l-765-450v-585l765,459v576Z"></path>
            <path fill="#04d5eb" d="M1640,1605l765-450v-585l-765,459v576Z"></path>
          </g>
        </g>

        <mask id="logoMask" maskUnits="userSpaceOnUse" x="0" y="0" width="3326" height="2408">
          <use href="#logo-geometry"></use>
        </mask>

        <linearGradient id="gradA" x1="-20%" y1="0%" x2="120%" y2="0%" spreadMethod="reflect">
          <stop offset="0%">
            <animate attributeName="stop-color" dur="12s" repeatCount="indefinite"
              values="#00E5FF; #FF5EA0; #FFD300; #00FF87; #00E5FF"></animate>
          </stop>
          <stop offset="50%">
            <animate attributeName="stop-color" dur="12s" repeatCount="indefinite"
              values="#7A5CFF; #00FF87; #FF5EA0; #00E5FF; #7A5CFF"></animate>
          </stop>
          <stop offset="100%">
            <animate attributeName="stop-color" dur="12s" repeatCount="indefinite"
              values="#FF5EA0; #FFD300; #00E5FF; #7A5CFF; #FF5EA0"></animate>
          </stop>
          <animateTransform attributeName="gradientTransform" type="translate" dur="12s"
            repeatCount="indefinite" values="-0.4 0; 0.4 0; -0.4 0"></animateTransform>
        </linearGradient>
      </defs>

      <g mask="url(#logoMask)">
        <rect x="0" y="0" width="3326" height="2408" fill="url(#gradA)"></rect>
      </g>
    </symbol>
  </svg>

  <button class="burger" id="burgerBtn" aria-label="Menü öffnen">
    <div class="lines" aria-hidden="true">
      <span></span><span></span><span></span>
    </div>
  </button>

  <div class="top-links" aria-label="Quick Links">
    <a class="top-link" href="/news.html" aria-label="News">
      <strong>News</strong><span>Updates</span>
    </a>
    <a class="top-link" href="/events.html" aria-label="Events">
      <strong>Events</strong><span>Dates</span>
    </a>
  </div>

  <nav class="drawer" id="drawer" aria-label="Menü">
    <a href="/index.html">
      Home
      <small>Start</small>
    </a>
    <a href="/news.html">
      News
      <small>Updates</small>
    </a>
    <a href="/events.html">
      Events
      <small>Dates</small>
    </a>
    <a href="/index.html#impressum">
      Impressum
      <small>Legal</small>
    </a>
  </nav>
  <div class="drawer-backdrop" id="drawerBackdrop" aria-hidden="true"></div>

  <header class="site" aria-label="Navigation">
    <div class="nav-brand">
      <div class="nav-logo" aria-hidden="true">
        <svg class="logo-svg" viewBox="0 0 3326 2408" preserveAspectRatio="xMidYMid meet">
          <use href="#sethub-logo"></use>
        </svg>
      </div>
      <div class="nav-text" aria-label="SetHub">
        <span>S</span><span>e</span><span>t</span><span>H</span><span>u</span><span>b</span>
      </div>
    </div>
  </header>

  <main>
    <div class="panel">
      <div class="section-title">Trending</div>

      <div class="slider" aria-label="News Slider">
        <div class="track" id="track">
          <a class="slide" href="#" aria-label="Lädt">
            <img src="/Bilder/real1.png" alt="Lädt" />
            <div class="fade" aria-hidden="true"></div>
            <div class="meta">
              <div class="small">Lädt</div>
              <div class="big">News</div>
            </div>
          </a>
        </div>
      </div>

      <div class="dots" aria-label="Slider Punkte" id="dots"></div>

      <div class="section-title" style="margin-top:20px">News</div>

      <div class="row3" id="newsGrid">
        <div class="skeleton"></div>
        <div class="skeleton"></div>
        <div class="skeleton"></div>
        <div class="skeleton"></div>
        <div class="skeleton"></div>
        <div class="skeleton"></div>
      </div>
    </div>
  </main>

  <script>
    const API_URL = "https://sethub.ddnsfree.com/InfoScraper/api/LegoNews"
    const FALLBACK_IMG = "/Bilder/real1.png"

    const burgerBtn = document.getElementById("burgerBtn")
    const drawerBackdrop = document.getElementById("drawerBackdrop")

    function openDrawer(){ document.body.classList.add("drawer-open") }
    function closeDrawer(){ document.body.classList.remove("drawer-open") }

    burgerBtn.addEventListener("click", () => {
      if(document.body.classList.contains("drawer-open")) closeDrawer()
      else openDrawer()
    })
    drawerBackdrop.addEventListener("click", closeDrawer)
    addEventListener("keydown", e => { if(e.key === "Escape") closeDrawer() })

    function formatDate(iso){
      const d = new Date(iso)
      if(Number.isNaN(d.getTime())) return ""
      const day = String(d.getDate()).padStart(2,"0")
      const mon = String(d.getMonth() + 1).padStart(2,"0")
      const yr = String(d.getFullYear())
      return `${day}.${mon}.${yr}`
    }

    function safeText(s){
      return String(s || "").replaceAll("<","").replaceAll(">","")
    }

    function pickLocale(items){
      const de = items.filter(x => (x.sourceUrl || "").includes("/de-"))
      return de.length ? de : items
    }

    function dedupe(items){
      const best = new Map()
      for(const it of items){
        const title = (it.title || "").trim()
        const date = (it.publishedAt || "").trim()
        const key = `${title}__${date}`
        const cur = best.get(key)
        if(!cur){ best.set(key, it); continue }
        const curIsDe = (cur.sourceUrl || "").includes("/de-")
        const itIsDe = (it.sourceUrl || "").includes("/de-")
        if(!curIsDe && itIsDe) best.set(key, it)
      }
      return Array.from(best.values())
    }

    function byDateDesc(a,b){
      return new Date(b.publishedAt || 0).getTime() - new Date(a.publishedAt || 0).getTime()
    }

    function buildSlide(item){
      const href = item.sourceUrl || "#"
      const img = item.imageUrl || FALLBACK_IMG
      const title = safeText(item.title || "News")
      const date = formatDate(item.publishedAt)

      return `
        <a class="slide" href="${href}" target="_blank" rel="noopener" aria-label="${title}">
          <img src="${img}" alt="${title}" onerror="this.onerror=null;this.src='${FALLBACK_IMG}'">
          <div class="fade" aria-hidden="true"></div>
          <div class="meta">
            <div class="small">${date}</div>
            <div class="big">${title}</div>
          </div>
        </a>
      `
    }

    function buildCard(item){
      const href = item.sourceUrl || "#"
      const img = item.imageUrl || FALLBACK_IMG
      const title = safeText(item.title || "News")
      const date = formatDate(item.publishedAt)

      return `
        <a class="news-card" href="${href}" target="_blank" rel="noopener" aria-label="${title}">
          <div class="thumb">
            <img src="${img}" alt="${title}" onerror="this.onerror=null;this.src='${FALLBACK_IMG}'">
            <div class="arrow" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M7 17L17 7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M9 7h8v8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
          </div>
          <div class="txt">
            <div class="t1">${title}</div>
            <div class="t2">${date}</div>
          </div>
        </a>
      `
    }

    function mountDots(count){
      const dotsEl = document.getElementById("dots")
      dotsEl.innerHTML = ""
      for(let i = 0; i < count; i++){
        dotsEl.insertAdjacentHTML(
          "beforeend",
          `<button class="dot" type="button" aria-current="${i===0}" data-i="${i}" aria-label="Slide ${i+1}"></button>`
        )
      }
    }

    function sliderSetup(){
      const track = document.getElementById("track")
      const dots = Array.from(document.querySelectorAll("#dots .dot"))
      if(!dots.length) return

      let idx = 0
      let timer = null

      function go(i){
        idx = i
        track.style.transform = `translateX(${idx * -100}%)`
        dots.forEach((d,n) => d.setAttribute("aria-current", String(n === idx)))
      }

      function next(){
        const max = dots.length - 1
        go(idx >= max ? 0 : idx + 1)
      }

      function restart(){
        if(timer) clearInterval(timer)
        timer = setInterval(next, 4500)
      }

      dots.forEach(d => {
        d.addEventListener("click", () => {
          go(Number(d.getAttribute("data-i") || "0"))
          restart()
        })
      })

      go(0)
      restart()
    }

    function withTimeout(ms){
      const controller = new AbortController()
      const t = setTimeout(() => controller.abort(), ms)
      return { signal: controller.signal, clear: () => clearTimeout(t) }
    }

    async function loadNews(){
      const track = document.getElementById("track")
      const grid = document.getElementById("newsGrid")

      const { signal, clear } = withTimeout(9000)

      let res
      try{
        res = await fetch(API_URL, {
          method:"GET",
          mode:"cors",
          cache:"no-store",
          headers:{ "Accept":"application/json" },
          signal
        })
      } finally {
        clear()
      }

      if(!res.ok){
        track.innerHTML = buildSlide({
          title:"API Fehler",
          publishedAt:new Date().toISOString(),
          imageUrl:FALLBACK_IMG,
          sourceUrl:"#"
        })
        document.getElementById("dots").innerHTML = ""
        grid.innerHTML = ""
        return
      }

      const data = await res.json()

      const list = Array.isArray(data) ? data : []
      const clean = dedupe(pickLocale(list)).sort(byDateDesc)

      const sliderItems = clean.slice(0,5)
      const cardItems = clean.slice(0,6)

      track.innerHTML = sliderItems.map(buildSlide).join("")
      mountDots(sliderItems.length)

      grid.innerHTML = cardItems.map(buildCard).join("")
      sliderSetup()
    }

    loadNews().catch(() => {
      const track = document.getElementById("track")
      const grid = document.getElementById("newsGrid")
      track.innerHTML = buildSlide({
        title:"Keine Verbindung",
        publishedAt:new Date().toISOString(),
        imageUrl:FALLBACK_IMG,
        sourceUrl:"#"
      })
      document.getElementById("dots").innerHTML = ""
      grid.innerHTML = ""
    })
  </script>
</body>
</html>
